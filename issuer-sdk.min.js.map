{"version":3,"file":"issuer-sdk.min.js","sources":["../src/lib/sdk.js"],"sourcesContent":["// JavaScript SDK for Developer API\n// Usage: import sdk from './sdk';\n\nconst API_BASE = '/api/dev';\n\nclass IssuerSDK {\n  constructor(apiKey) {\n    this.apiKey = apiKey;\n  }\n\n  setApiKey(apiKey) {\n    this.apiKey = apiKey;\n  }\n\n  // Helper for API requests\n  async _request(method, path, body) {\n    const opts = {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.apiKey}`,\n      },\n    };\n    if (body) opts.body = JSON.stringify(body);\n    const res = await fetch(`${API_BASE}${path}`, opts);\n    if (!res.ok) throw new Error(await res.text());\n    return res.json();\n  }\n\n  // Credentials\n  async issueCredential(data) {\n    return this._request('POST', '/credentials/issue', data);\n  }\n  async getCredential(id) {\n    return this._request('GET', `/credentials/${id}`);\n  }\n\n  // Payments\n  async sendPayment(data) {\n    return this._request('POST', '/payments/send', data);\n  }\n  async getWalletBalance() {\n    return this._request('GET', '/wallet/balance');\n  }\n\n  // Webhooks\n  async registerWebhook(data) {\n    return this._request('POST', '/webhooks/register', data);\n  }\n  async getWebhooks() {\n    return this._request('GET', '/webhooks');\n  }\n  async getWebhookLogs() {\n    return this._request('GET', '/webhooks/logs');\n  }\n\n  // API Keys\n  async getApiKeys() {\n    return this._request('GET', '/api-keys');\n  }\n  async createApiKey(data) {\n    return this._request('POST', '/api-keys', data);\n  }\n  async revokeApiKey(data) {\n    return this._request('POST', '/api-keys/revoke', data);\n  }\n\n  // Usage\n  async getUsage() {\n    return this._request('GET', '/usage');\n  }\n\n  // Webhook listener (polling)\n  startWebhookPolling(callback, interval = 5000) {\n    if (this._webhookPolling) return;\n    this._webhookPolling = true;\n    let lastTimestamp = null;\n    const poll = async () => {\n      if (!this._webhookPolling) return;\n      try {\n        const logs = await this.getWebhookLogs();\n        // Filter new events by timestamp\n        const newEvents = logs.filter(e => !lastTimestamp || new Date(e.timestamp) > new Date(lastTimestamp));\n        if (newEvents.length > 0) {\n          lastTimestamp = newEvents[newEvents.length - 1].timestamp;\n          newEvents.forEach(callback);\n        }\n      } catch (e) {\n        // Optionally handle error\n      }\n      if (this._webhookPolling) {\n        this._webhookPollingTimeout = setTimeout(poll, interval);\n      }\n    };\n    poll();\n  }\n\n  stopWebhookPolling() {\n    this._webhookPolling = false;\n    if (this._webhookPollingTimeout) {\n      clearTimeout(this._webhookPollingTimeout);\n      this._webhookPollingTimeout = null;\n    }\n  }\n\n  onWebhook(callback, interval) {\n    this.startWebhookPolling(callback, interval);\n  }\n}\n\nconst sdk = {\n  IssuerSDK,\n};\n\nmodule.exports = sdk; "],"names":[],"mappings":";;;;;EAAA;EACA;;EAEA,MAAM,QAAQ,GAAG,UAAU;;EAE3B,MAAM,SAAS,CAAC;EAChB,EAAE,WAAW,CAAC,MAAM,EAAE;EACtB,IAAI,IAAI,CAAC,MAAM,GAAG,MAAM;EACxB,EAAE;;EAEF,EAAE,SAAS,CAAC,MAAM,EAAE;EACpB,IAAI,IAAI,CAAC,MAAM,GAAG,MAAM;EACxB,EAAE;;EAEF;EACA,EAAE,MAAM,QAAQ,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE;EACrC,IAAI,MAAM,IAAI,GAAG;EACjB,MAAM,MAAM;EACZ,MAAM,OAAO,EAAE;EACf,QAAQ,cAAc,EAAE,kBAAkB;EAC1C,QAAQ,eAAe,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;EAChD,OAAO;EACP,KAAK;EACL,IAAI,IAAI,IAAI,EAAE,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;EAC9C,IAAI,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,CAAC,EAAE,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC;EACvD,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,EAAE,CAAC;EAClD,IAAI,OAAO,GAAG,CAAC,IAAI,EAAE;EACrB,EAAE;;EAEF;EACA,EAAE,MAAM,eAAe,CAAC,IAAI,EAAE;EAC9B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,oBAAoB,EAAE,IAAI,CAAC;EAC5D,EAAE;EACF,EAAE,MAAM,aAAa,CAAC,EAAE,EAAE;EAC1B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;EACrD,EAAE;;EAEF;EACA,EAAE,MAAM,WAAW,CAAC,IAAI,EAAE;EAC1B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,gBAAgB,EAAE,IAAI,CAAC;EACxD,EAAE;EACF,EAAE,MAAM,gBAAgB,GAAG;EAC3B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,iBAAiB,CAAC;EAClD,EAAE;;EAEF;EACA,EAAE,MAAM,eAAe,CAAC,IAAI,EAAE;EAC9B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,oBAAoB,EAAE,IAAI,CAAC;EAC5D,EAAE;EACF,EAAE,MAAM,WAAW,GAAG;EACtB,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,WAAW,CAAC;EAC5C,EAAE;EACF,EAAE,MAAM,cAAc,GAAG;EACzB,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,gBAAgB,CAAC;EACjD,EAAE;;EAEF;EACA,EAAE,MAAM,UAAU,GAAG;EACrB,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,WAAW,CAAC;EAC5C,EAAE;EACF,EAAE,MAAM,YAAY,CAAC,IAAI,EAAE;EAC3B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,WAAW,EAAE,IAAI,CAAC;EACnD,EAAE;EACF,EAAE,MAAM,YAAY,CAAC,IAAI,EAAE;EAC3B,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,kBAAkB,EAAE,IAAI,CAAC;EAC1D,EAAE;;EAEF;EACA,EAAE,MAAM,QAAQ,GAAG;EACnB,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;EACzC,EAAE;;EAEF;EACA,EAAE,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,GAAG,IAAI,EAAE;EACjD,IAAI,IAAI,IAAI,CAAC,eAAe,EAAE;EAC9B,IAAI,IAAI,CAAC,eAAe,GAAG,IAAI;EAC/B,IAAI,IAAI,aAAa,GAAG,IAAI;EAC5B,IAAI,MAAM,IAAI,GAAG,YAAY;EAC7B,MAAM,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;EACjC,MAAM,IAAI;EACV,QAAQ,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE;EAChD;EACA,QAAQ,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,aAAa,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC;EAC7G,QAAQ,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;EAClC,UAAU,aAAa,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,SAAS;EACnE,UAAU,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC;EACrC,QAAQ;EACR,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;EAClB;EACA,MAAM;EACN,MAAM,IAAI,IAAI,CAAC,eAAe,EAAE;EAChC,QAAQ,IAAI,CAAC,sBAAsB,GAAG,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC;EAChE,MAAM;EACN,IAAI,CAAC;EACL,IAAI,IAAI,EAAE;EACV,EAAE;;EAEF,EAAE,kBAAkB,GAAG;EACvB,IAAI,IAAI,CAAC,eAAe,GAAG,KAAK;EAChC,IAAI,IAAI,IAAI,CAAC,sBAAsB,EAAE;EACrC,MAAM,YAAY,CAAC,IAAI,CAAC,sBAAsB,CAAC;EAC/C,MAAM,IAAI,CAAC,sBAAsB,GAAG,IAAI;EACxC,IAAI;EACJ,EAAE;;EAEF,EAAE,SAAS,CAAC,QAAQ,EAAE,QAAQ,EAAE;EAChC,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC;EAChD,EAAE;EACF;;EAEA,MAAM,GAAG,GAAG;EACZ,EAAE,SAAS;EACX,CAAC;;EAED,MAAM,CAAC,OAAO,GAAG,GAAG;;;;;;"}